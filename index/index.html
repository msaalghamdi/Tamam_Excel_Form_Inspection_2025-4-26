<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نموذج التفتيش - علاقة العمل</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 30px;
        }
        .section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            border-right: 4px solid #3498db;
        }
        .section-title {
            font-weight: bold;
            color: #2980b9;
            margin-bottom: 10px;
        }
        .criteria-row {
            display: flex;
            margin-bottom: 10px;
            padding: 8px;
            background-color: white;
            border-radius: 4px;
            align-items: center;
        }
        .criteria-name {
            flex: 3;
            font-weight: bold;
        }
        .criteria-weight {
            flex: 1;
            text-align: center;
        }
        .criteria-opinion {
            flex: 2;
        }
        .criteria-notes {
            flex: 3;
        }
        select, input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100%;
        }
        .info-row {
            display: flex;
            margin-bottom: 15px;
        }
        .info-item {
            flex: 1;
            margin-left: 10px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin-top: 20px;
        }
        button:hover {
            background-color: #2980b9;
        }
        .total {
            font-weight: bold;
            text-align: center;
            font-size: 18px;
            margin: 20px 0;
        }
        .note {
            font-style: italic;
            color: #7f8c8d;
            margin: 10px 0;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>جدول المعايير والأوزان الاسترشادية الموحد</h1>
        
        <div class="info-row">
            <div class="info-item">
                <label>رقم السجل التجاري</label>
                <input type="text" id="commercial-registry">
            </div>
            <div class="info-item">
                <label>رقم المنشأة</label>
                <input type="text" id="establishment-number">
            </div>
        </div>
        
        <div class="info-row">
            <div class="info-item">
                <label>رقم هوية العامل</label>
                <input type="text" id="worker-id">
            </div>
            <div class="info-item">
                <label>اسم العامل</label>
                <input type="text" id="worker-name">
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">عناصر صحة علاقة العمل - محور العمل والتبعية</div>
            
            <div class="criteria-row">
                <div class="criteria-name">عقد العمل</div>
                <div class="criteria-weight">10</div>
                <div class="criteria-opinion">
                    <select id="criteria1">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes1" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">تسجيل المشترك/هـ كمسؤول أو مشرف في احد أنظمة الجهات الحكومية</div>
                <div class="criteria-weight">20</div>
                <div class="criteria-opinion">
                    <select id="criteria2">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes2" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">تأمين طبي سابق لتاريخ التفتيش</div>
                <div class="criteria-weight">15</div>
                <div class="criteria-opinion">
                    <select id="criteria3">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes3" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">التحقق من صحة علاقة العمل عن طريق سؤال المشترك أو بقية المشتركين</div>
                <div class="criteria-weight">15</div>
                <div class="criteria-opinion">
                    <select id="criteria4">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes4" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">مستندات لبعض أعمال المشترك/هـ خاصة بالفترة المطلوبة</div>
                <div class="criteria-weight">10</div>
                <div class="criteria-opinion">
                    <select id="criteria5">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes5" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">القرارات الإدارية للمشترك</div>
                <div class="criteria-weight">5</div>
                <div class="criteria-opinion">
                    <select id="criteria6">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes6" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">إقرار المشترك بعدم العمل</div>
                <div class="criteria-weight">-30</div>
                <div class="criteria-opinion">
                    <select id="criteria7">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes7" placeholder="ملاحظات">
                </div>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">عناصر صحة علاقة العمل - محور الأجر</div>
            
            <div class="criteria-row">
                <div class="criteria-name">الأجر من خلال برنامج حماية الأجور ويشمل التحويلات البنكية</div>
                <div class="criteria-weight">20</div>
                <div class="criteria-opinion">
                    <select id="criteria8">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes8" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">مسيرات رواتب او سندات صرف (في حال عدم وجود حوالات بنكية)</div>
                <div class="criteria-weight">5</div>
                <div class="criteria-opinion">
                    <select id="criteria9">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes9" placeholder="ملاحظات">
                </div>
            </div>
        </div>
        
        <div class="section">
            <div class="section-title">رأي المفتش</div>
            
            <div class="criteria-row">
                <div class="criteria-name">توافق المعلومات التي اطلع عليها المفتش</div>
                <div class="criteria-weight">5</div>
                <div class="criteria-opinion">
                    <select id="criteria10">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes10" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">تواجد المشترك/ة</div>
                <div class="criteria-weight">5</div>
                <div class="criteria-opinion">
                    <select id="criteria11">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes11" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">العلاقة الشخصية بين المشترك وصاحب العمل</div>
                <div class="criteria-weight">5</div>
                <div class="criteria-opinion">
                    <select id="criteria12">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes12" placeholder="ملاحظات">
                </div>
            </div>
            
            <div class="criteria-row">
                <div class="criteria-name">موثوقية المستندات</div>
                <div class="criteria-weight">5</div>
                <div class="criteria-opinion">
                    <select id="criteria13">
                        <option value="">الرجاء الإختيار</option>
                        <option value="تم التحقق">تم التحقق</option>
                        <option value="لم يتم التحقق">لم يتم التحقق</option>
                    </select>
                </div>
                <div class="criteria-notes">
                    <input type="text" id="notes13" placeholder="ملاحظات">
                </div>
            </div>
        </div>
        
        <div class="total">المجموع: <span id="total-score">0</span></div>
        
        <div class="note">يتم اعتبار علاقة العمل صحيحة (40 درجة) فأكثر بشرط توفر عنصر بكل محور من المحاور الثلاثة</div>
        
        <button onclick="generateExcel()">توليد ملف Excel</button>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        function calculateTotal() {
            let total = 0;
            
            // محور العمل والتبعية
            if(document.getElementById('criteria1').value === 'تم التحقق') total += 10;
            if(document.getElementById('criteria2').value === 'تم التحقق') total += 20;
            if(document.getElementById('criteria3').value === 'تم التحقق') total += 15;
            if(document.getElementById('criteria4').value === 'تم التحقق') total += 15;
            if(document.getElementById('criteria5').value === 'تم التحقق') total += 10;
            if(document.getElementById('criteria6').value === 'تم التحقق') total += 5;
            if(document.getElementById('criteria7').value === 'تم التحقق') total += -30;
            
            // محور الأجر
            if(document.getElementById('criteria8').value === 'تم التحقق') total += 20;
            if(document.getElementById('criteria9').value === 'تم التحقق') total += 5;
            
            // رأي المفتش
            if(document.getElementById('criteria10').value === 'تم التحقق') total += 5;
            if(document.getElementById('criteria11').value === 'تم التحقق') total += 5;
            if(document.getElementById('criteria12').value === 'تم التحقق') total += 5;
            if(document.getElementById('criteria13').value === 'تم التحقق') total += 5;
            
            document.getElementById('total-score').textContent = total;
            return total;
        }
        
        // تحديث المجموع عند تغيير أي اختيار
        document.querySelectorAll('select').forEach(select => {
            select.addEventListener('change', calculateTotal);
        });
        
        function generateExcel() {
            // إنشاء كائن ورقة عمل
            const wb = XLSX.utils.book_new();
            const ws_data = [];
            
            // إضافة العناوين
            ws_data.push(["جدول المعايير والأوزان الاسترشادية الموحد", "", "", "", "", "", "", ""]);
            ws_data.push(["عناصر صحة علاقة العمل", "المعيار", "", "وزن المعيار", "رأي المفتش بشأن المعيار", "ملاحظات", "", "درجة المعيار"]);
            ws_data.push(["", "", "", "", "تم التحقق / لم يتم التحقق", "", "", ""]);
            ws_data.push(["", "", "", "", "", "", "", ""]);
            ws_data.push(["", "", "", "", "", "", "", ""]);
            ws_data.push(["", "", "", "", "", "", "", ""]);
            ws_data.push(["", "", "", "", "", "", "", ""]);
            
            // محور العمل والتبعية
            ws_data.push([
                "العمل و التبعية",
                "عقد العمل",
                "",
                "10",
                document.getElementById('criteria1').value,
                document.getElementById('notes1').value,
                "",
                document.getElementById('criteria1').value === 'تم التحقق' ? 10 : 0
            ]);
            
            ws_data.push([
                "",
                "تسجيل المشترك/هـ كمسؤول أو مشرف في احد أنظمة الجهات الحكومية او في أحد المنصات الحكومية المعتمدة (مثل: منصة نور للمعلمين- مشرف المنشأه في التأمينات) / وكلات شرعية  /  حكم قضائي  مكتسب القطعية",
                "",
                "20",
                document.getElementById('criteria2').value,
                document.getElementById('notes2').value,
                "",
                document.getElementById('criteria2').value === 'تم التحقق' ? 20 : 0
            ]);
            
            ws_data.push([
                "",
                "تأمين طبي سابق لتاريخ التفتيش (يتم التحقق من صحة التأمين عن طريق مجلس الضمان الصحي )",
                "",
                "15",
                document.getElementById('criteria3').value,
                document.getElementById('notes3').value,
                "",
                document.getElementById('criteria3').value === 'تم التحقق' ? 15 : 0
            ]);
            
            ws_data.push([
                "",
                "التحقق من صحة علاقة العمل عن طريق سؤال المشترك محل البحث حول طبيعة العمل و نشاط المنشاة و موقع العمل أو التحقق من صحة علاقة العمل عن طريق سؤال بقية المشتركين عن المشترك محل البحث",
                "",
                "15",
                document.getElementById('criteria4').value,
                document.getElementById('notes4').value,
                "",
                document.getElementById('criteria4').value === 'تم التحقق' ? 15 : 0
            ]);
            
            ws_data.push([
                "",
                "مستندات لبعض أعمال المشترك/هـ خاصة بالفترة المطلوبة (لابد أن تتوافق مع طبيعة عمل المنشأة ومؤهلات المشترك )",
                "",
                "10",
                document.getElementById('criteria5').value,
                document.getElementById('notes5').value,
                "",
                document.getElementById('criteria5').value === 'تم التحقق' ? 10 : 0
            ]);
            
            ws_data.push([
                "",
                "القرارات الادارية تصدر للمشترك والقرارات الخارجية مثل (قرارات الترقية/قرارة الزيادة في الاجر / تقارير طبية بإجازة مرضيه /كشوف الحضور والانصراف  )",
                "",
                "5",
                document.getElementById('criteria6').value,
                document.getElementById('notes6').value,
                "",
                document.getElementById('criteria6').value === 'تم التحقق' ? 5 : 0
            ]);
            
            ws_data.push([
                "",
                "إقرار المشترك بعدم العمل",
                "",
                "30",
                document.getElementById('criteria7').value,
                document.getElementById('notes7').value,
                "",
                document.getElementById('criteria7').value === 'تم التحقق' ? -30 : 0
            ]);
            
            // محور الأجر
            ws_data.push([
                "الأجر",
                "الأجر من خلال برنامج حماية الأجور ويشمل التحويلات البنكية",
                "",
                "20",
                document.getElementById('criteria8').value,
                document.getElementById('notes8').value,
                "",
                document.getElementById('criteria8').value === 'تم التحقق' ? 20 : 0
            ]);
            
            ws_data.push([
                "",
                "مسيرات رواتب او سندات صرف  ( في حال عدم وجود حوالات بنكية)",
                "",
                "5",
                document.getElementById('criteria9').value,
                document.getElementById('notes9').value,
                "",
                document.getElementById('criteria9').value === 'تم التحقق' ? 5 : 0
            ]);
            
            // رأي المفتش
            ws_data.push([
                "رأي المفتش",
                "توافق المعلومات التي إطلع عليها المفتش",
                "",
                "5",
                document.getElementById('criteria10').value,
                document.getElementById('notes10').value,
                "",
                document.getElementById('criteria10').value === 'تم التحقق' ? 5 : 0
            ]);
            
            ws_data.push([
                "",
                "تواجد المشترك/ة",
                "",
                "5",
                document.getElementById('criteria11').value,
                document.getElementById('notes11').value,
                "",
                document.getElementById('criteria11').value === 'تم التحقق' ? 5 : 0
            ]);
            
            ws_data.push([
                "",
                "العلاقة الشخصية بين المشترك وصاحب العمل",
                "",
                "5",
                document.getElementById('criteria12').value,
                document.getElementById('notes12').value,
                "",
                document.getElementById('criteria12').value === 'تم التحقق' ? 5 : 0
            ]);
            
            ws_data.push([
                "",
                "موثوقية المستندات",
                "",
                "5",
                document.getElementById('criteria13').value,
                document.getElementById('notes13').value,
                "",
                document.getElementById('criteria13').value === 'تم التحقق' ? 5 : 0
            ]);
            
            ws_data.push(["يتم اعتبار علاقة العمل صحيحة  (40 درجة) فأكثر بشرط توفر عنصر بكل محور من المحاور الثلاثة", "", "", "", "", "", "", ""]);
            
            // معلومات المنشأة والعامل
            ws_data.push(["رقم السجل التجاري", "", "", "رقم المنشأة", "", "", "", ""]);
            ws_data.push([
                document.getElementById('commercial-registry').value,
                "",
                "",
                document.getElementById('establishment-number').value,
                "",
                "",
                "",
                ""
            ]);
            
            ws_data.push(["رقم هوية العامل", "", "", "اسم العامل", "", "", "", ""]);
            ws_data.push([
                document.getElementById('worker-id').value,
                "",
                "",
                document.getElementById('worker-name').value,
                "",
                "",
                "",
                ""
            ]);
            
            // المجموع
            ws_data.push(["المجموع", "", "", "", "", "", calculateTotal(), ""]);
            
            // تحويل البيانات إلى ورقة عمل
            const ws = XLSX.utils.aoa_to_sheet(ws_data);
            
            // إضافة ورقة العمل إلى كائن المصنف
            XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
            
            // توليد ملف Excel وتنزيله
            XLSX.writeFile(wb, "نموذج_التفتيش.xlsx");
        }
    </script>
</body>
</html>